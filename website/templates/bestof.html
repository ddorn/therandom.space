{% extends "layouts/regular.html" %}
{% from "macros/macros.html" import icon %}

{% block content %}
    <div>
        <div class="flex justify-between font-bold text-lg">
            <div>Proverbe</div>
            <div>Likes</div>
        </div>

        <div class="space-y-8 mt-4 text-4xl">

            {% for best in bests %}
                <div class="line-tag flex flex-col
                    md:flex-row md:justify-between items-center
                    font-medium leading-snug
                    bg-gray-800 rounded-lg border border-gray-500
                    px-6 py-8 ">
                    <span class="pb-4 md:pb-0 md:pr-4">{{ best[0] }}</span>
                    <button class="flex items-center self-end md:self-center w-min bg-gray-700 rounded-full px-6 py-2 border border-gray-500 hover:bg-gray-600 focus:outline-none focus:border-orange max-h-16">
                        <span>{{ best[1] }}</span> {{ icon("heart", "inline h-8 ml-2 ") }}
                    </button>
                </div>
            {% endfor %}
        </div>
    </div>
    <script>
        document.querySelectorAll(".line-tag").forEach(line => {
            let [quote, likes] = line.children;
            likes.addEventListener('click', _ => {
                fetch('{{ url_for("like", kind="proverb") }}', {
                    method: 'post',
                    body: JSON.stringify({ 'quote': quote.innerText }),
                    headers: { 'Content-Type': 'application/json' }
                }).then(resp => resp.json()
                    .then(data => {
                        likes.style.color = "#ffa500";
                        likes.children[0].innerHTML = data.likes;
                    })
                )
            })
        })
    </script>
{% endblock %}
